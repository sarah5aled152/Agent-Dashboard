<!-- Outer "card-like" container -->
<div class="ml-4 mb-8 bg-white border border-gray-200 rounded-xl shadow p-6">
  <!-- Header (Title) -->
  <div class="flex items-center mb-6">
    <h2 class="text-xl font-semibold text-gray-800">Edit Profile</h2>
  </div>

  <!-- Success Message -->
  <div *ngIf="success" class="mb-4 p-3 bg-green-100 text-green-700 rounded">
    {{ success }}
  </div>

  <!-- Error Message -->
  <div *ngIf="error" class="mb-4 p-3 bg-red-100 text-red-700 rounded">
    {{ error }}
  </div>

  <form [formGroup]="profileForm" (submit)="onSubmit()">
    <!-- Profile Photo -->
    <div class="mb-6">
      <label class="font-medium block text-gray-700 mb-2">Profile Photo</label>
      <div class="flex items-center space-x-4">
        <img
          [src]="previewImage || defaultImage"
          (error)="handleImageError($event)"
          alt="Profile Preview"
          class="w-20 h-20 rounded-full object-cover border-2 border-gray-200"
        />
        <div class="flex flex-col space-y-2">
          <input
            type="file"
            accept="image/*"
            (change)="onFileSelected($event)"
            class="hidden"
            #fileInput
          />
          <button
            type="button"
            (click)="fileInput.click()"
            class="px-4 py-2 text-sm text-indigo-600 border border-indigo-600 rounded-md hover:bg-indigo-50"
          >
            Change Photo
          </button>
        </div>
      </div>
    </div>

    <!-- Name Field -->
    <div class="mb-4">
      <label for="name" class="font-medium block text-gray-700 mb-1">
        Name
      </label>
      <input
        type="text"
        formControlName="name"
        id="name"
        class="w-full rounded-md border border-gray-300 focus:outline-none focus:ring-1 focus:ring-indigo-500 px-3 py-2"
        [ngClass]="{ 'border-red-500': isFieldInvalid('name') }"
        required
      />
      <small
        *ngIf="isFieldInvalid('name')"
        class="text-red-700 flex items-center mt-1"
      >
        <i class="fas fa-exclamation-circle mr-1"></i>
        {{ getErrorMessage("name") }}
      </small>
      <div *ngIf="isFieldInvalid('fieldName')" class="error-message">
        {{ getErrorMessage('fieldName') }}
      </div>
    </div>

    <!-- Phone Field -->
    <div class="mb-4">
      <label for="phone" class="font-medium block text-gray-700 mb-1">
        Phone
      </label>
      <input
        type="tel"
        formControlName="phone"
        id="phone"
        placeholder="+20 10 XXXX XXXX or 010 XXXX XXXX"
        class="w-full rounded-md border border-gray-300 focus:outline-none focus:ring-1 focus:ring-indigo-500 px-3 py-2"
        [ngClass]="{ 'border-red-500': isFieldInvalid('phone') }"
        required
      />
      <small
        *ngIf="isFieldInvalid('phone')"
        class="text-red-700 flex items-center mt-1"
      >
        <i class="fas fa-exclamation-circle mr-1"></i>
        {{ getErrorMessage("phone") }}
      </small>
      <div *ngIf="isFieldInvalid('fieldName')" class="error-message">
        {{ getErrorMessage('fieldName') }}
      </div>
    </div>

    <!-- Email Field -->
    <div class="mb-4">
      <label for="email" class="font-medium block text-gray-700 mb-1">
        Email
      </label>
      <input
        type="email"
        formControlName="email"
        id="email"
        class="w-full rounded-md border border-gray-300 focus:outline-none focus:ring-1 focus:ring-indigo-500 px-3 py-2"
        [ngClass]="{ 'border-red-500': isFieldInvalid('email') }"
        required
      />
      <small
        *ngIf="isFieldInvalid('email')"
        class="text-red-700 flex items-center mt-1"
      >
        <i class="fas fa-exclamation-circle mr-1"></i>
        {{ getErrorMessage("email") }}
      </small>
      <div *ngIf="isFieldInvalid('fieldName')" class="error-message">
        {{ getErrorMessage('fieldName') }}
      </div>
    </div>

    <!-- Loading state -->
    <div *ngIf="isLoading" class="mb-4">
      <div class="flex items-center justify-center">
        <div
          class="animate-spin rounded-full h-6 w-6 border-b-2 border-indigo-500"
        ></div>
        <span class="ml-2">Updating profile...</span>
      </div>
    </div>

    <!-- Submit Button -->
    <button
      type="submit"
      class="bg-indigo-500 text-white py-2 px-4 rounded-md"
      [disabled]="isLoading || profileForm.invalid"
    >
      {{ isLoading ? "Updating..." : "Update Profile" }}
    </button>
  </form>
</div>
